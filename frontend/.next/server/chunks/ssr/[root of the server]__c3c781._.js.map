{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 55, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/nikit/Downloads/supersoul/frontend/pages/_document.tsx"],"sourcesContent":["import { Html, Head, Main, NextScript } from \"next/document\";\n\nexport default function Document() {\n  return (\n    <Html lang=\"en\">\n      <Head />\n      <body className=\"antialiased\">\n        <Main />\n        <NextScript />\n      </body>\n    </Html>\n  );\n}\n"],"names":[],"mappings":";;;;AAAA;;;AAEe,SAAS;IACtB,qBACE,qKAAC,yHAAA,CAAA,OAAI;QAAC,MAAK;;0BACT,qKAAC,yHAAA,CAAA,OAAI;;;;;0BACL,qKAAC;gBAAK,WAAU;;kCACd,qKAAC,yHAAA,CAAA,OAAI;;;;;kCACL,qKAAC,yHAAA,CAAA,aAAU;;;;;;;;;;;;;;;;;AAInB"}},
    {"offset": {"line": 97, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 103, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/nikit/Downloads/supersoul/frontend/pages/_app.tsx"],"sourcesContent":["import \"@/styles/globals.css\";\nimport type { AppProps } from \"next/app\";\n\nexport default function App({ Component, pageProps }: AppProps) {\n  return <Component {...pageProps} />;\n}\n"],"names":[],"mappings":";;;;;;AAGe,SAAS,IAAI,EAAE,SAAS,EAAE,SAAS,EAAY;IAC5D,qBAAO,qKAAC;QAAW,GAAG,SAAS;;;;;;AACjC"}},
    {"offset": {"line": 118, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 164, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/nikit/Downloads/supersoul/frontend/pages/meeting/%5Bid%5D.tsx"],"sourcesContent":["import { useRouter } from \"next/router\";\r\nimport { AuthContext } from \"../../context/AuthContext\";\r\nimport { useEffect, useRef, useState } from \"react\";\r\nimport Peer from \"peerjs\";\r\n\r\nconst MeetingPage = () => {\r\n  const router = useRouter();\r\n  const { id: meetingId } = router.query;\r\n  const [peer, setPeer] = useState<Peer | null>(null);\r\n  const [socket, setSocket] = useState<WebSocket | null>(null);\r\n  const [localStream, setLocalStream] = useState<MediaStream | null>(null); // ✅ Store stream in state\r\n  const [meetingLink, setMeetingLink] = useState<string | null>(null);\r\n  const [copied, setCopied] = useState(false);\r\n  const [isMuted, setIsMuted] = useState(false);\r\n  const [isVideoOff, setIsVideoOff] = useState(false);\r\n  const myVideoRef = useRef<HTMLVideoElement>(null);\r\n  const remoteVideosRef = useRef<{ [key: string]: HTMLVideoElement }>({});\r\n  const [isAdmin, setIsAdmin] = useState(false);\r\n  const [pendingUsers, setPendingUsers] = useState<string[]>([]);\r\n  useEffect(() => {\r\n    if (!socket || !peer) return;\r\n  \r\n    socket.onmessage = (event) => {\r\n      const data = JSON.parse(event.data);\r\n  \r\n      if (data.type === \"approval-request\" && isAdmin) {\r\n        setPendingUsers((prev) => [...prev, data.peerId]);\r\n      }\r\n    };\r\n  }, [socket, peer]);\r\n  \r\n  const approveUser = (peerId: string) => {\r\n    setPendingUsers((prev) => prev.filter((id) => id !== peerId));\r\n  \r\n    if (socket) { // ✅ Ensure socket is not null before calling send()\r\n      socket.send(JSON.stringify({ type: \"approved\", peerId }));\r\n    } else {\r\n      console.warn(\"⚠️ WebSocket is not connected, cannot send approval.\");\r\n    }\r\n  };\r\n  \r\n  useEffect(() => {\r\n    if (!meetingId) return;\r\n\r\n    const websocketURL = process.env.NEXT_PUBLIC_WEBSOCKET_URL || \"ws://localhost:8000\";\r\n    const frontendURL = process.env.NEXT_PUBLIC_FRONTEND_URL || \"http://localhost:3000\";\r\n\r\n    setMeetingLink(`${frontendURL}/meeting/${meetingId}`);\r\n\r\n    const userPeerId = Math.random().toString(36).substring(7);\r\n    const newSocket = new WebSocket(`${websocketURL}/ws/${meetingId}/${userPeerId}`);\r\n\r\n    newSocket.onopen = () => {\r\n        console.log(\"✅ WebSocket Connected!\");\r\n        newSocket.send(JSON.stringify({ type: \"new-user\", peerId: userPeerId }));\r\n    };\r\n\r\n    newSocket.onmessage = (event) => {\r\n        const data = JSON.parse(event.data);\r\n        console.log(\"📩 WebSocket Message:\", data);\r\n\r\n        if (data.type === \"new-user\" && data.peerId !== userPeerId) {\r\n            console.log(`🔔 New participant joined: ${data.peerId}`);\r\n            callUser(data.peerId); // ✅ Ensure we call the new user\r\n        }\r\n    };\r\n\r\n    setSocket(newSocket);\r\n\r\n    return () => {\r\n        newSocket.close();\r\n    };\r\n}, [meetingId]); \r\n\r\n\r\n// ✅ Move getUserMedia() to a separate effect so it only runs once\r\nuseEffect(() => {\r\n    if (localStream || myVideoRef.current?.srcObject) return; // ✅ Prevent multiple calls\r\n\r\n    navigator.mediaDevices.getUserMedia({ video: true, audio: true })\r\n        .then((stream) => {\r\n            setLocalStream(stream);\r\n            if (myVideoRef.current) {\r\n                myVideoRef.current.srcObject = stream;\r\n            }\r\n        })\r\n        .catch((error) => console.error(\"❌ Camera/Microphone Error:\", error));\r\n}, []); // ✅ Only runs once\r\n\r\nuseEffect(() => {\r\n  const newPeer = new Peer(); // ✅ Initialize PeerJS\r\n  setPeer(newPeer);\r\n\r\n  newPeer.on(\"open\", (id) => {\r\n      console.log(`🎯 Peer ID: ${id}`);\r\n  });\r\n\r\n  return () => {\r\n      newPeer.destroy(); // ✅ Cleanup on unmount\r\n  };\r\n}, []); // ✅ Empty dependency array ensures it runs only once\r\nuseEffect(() => {\r\n  if (!peer || !localStream) return;\r\n\r\n  peer.on(\"call\", (call) => {\r\n      console.log(\"📞 Answering incoming call...\");\r\n\r\n      call.answer(localStream); // ✅ Ensure we send our stream\r\n\r\n      call.on(\"stream\", (remoteStream) => {\r\n          console.log(\"📹 Received Remote Stream\");\r\n          addRemoteVideo(call.peer, remoteStream);\r\n      });\r\n\r\n      call.on(\"error\", (err) => {\r\n          console.error(\"❌ Call Error:\", err);\r\n      });\r\n  });\r\n\r\n  return () => {\r\n      peer.off(\"call\"); // ✅ Cleanup event listener\r\n  };\r\n}, [peer, localStream]); \r\n// ✅ Runs when `peer` or `localStream` changes\r\n\r\nconst addRemoteVideo = (peerId: string, stream: MediaStream) => {\r\n  console.log(`📺 Adding video for: ${peerId}`);\r\n\r\n  // ✅ Check if video already exists\r\n  if (!remoteVideosRef.current[peerId]) {\r\n      const videoElement = document.createElement(\"video\");\r\n      videoElement.srcObject = stream;\r\n      videoElement.autoplay = true;\r\n      videoElement.playsInline = true;\r\n      videoElement.classList.add(\"w-48\", \"h-32\", \"rounded-lg\", \"border\");\r\n\r\n      document.getElementById(\"remote-videos\")?.appendChild(videoElement);\r\n      remoteVideosRef.current[peerId] = videoElement;\r\n  }\r\n};\r\n\r\n\r\nconst callUser = (remotePeerId: string) => {\r\n  if (!peer || !localStream) return;\r\n\r\n  console.log(`📞 Calling user: ${remotePeerId}`);\r\n  const call = peer.call(remotePeerId, localStream);\r\n\r\n  call.on(\"stream\", (remoteStream) => {\r\n      console.log(\"📹 Received Remote Stream\");\r\n      addRemoteVideo(remotePeerId, remoteStream);\r\n  });\r\n\r\n  call.on(\"error\", (err) => {\r\n      console.error(\"❌ Call Error:\", err);\r\n  });\r\n};\r\n\r\n\r\n\r\n\r\n\r\n  const copyLink = () => {\r\n    if (meetingLink) {\r\n      navigator.clipboard.writeText(meetingLink);\r\n      setCopied(true);\r\n      setTimeout(() => setCopied(false), 2000);\r\n    }\r\n  };\r\n\r\n  const toggleMute = () => {\r\n    if (!localStream) return;\r\n    localStream.getAudioTracks().forEach((track) => {\r\n      track.enabled = !track.enabled;\r\n    });\r\n    setIsMuted(!isMuted);\r\n  };\r\n\r\n  const toggleVideo = () => {\r\n    if (!localStream) return;\r\n    localStream.getVideoTracks().forEach((track) => {\r\n      track.enabled = !track.enabled;\r\n    });\r\n    setIsVideoOff(!isVideoOff);\r\n  };\r\n\r\n  // ✅ Leave Meeting\r\n  const leaveMeeting = () => {\r\n    if (socket) socket.close();\r\n    if (peer) peer.destroy();\r\n    router.push(\"/\");\r\n  };\r\n\r\n  return (\r\n    <div className=\"flex flex-col items-center justify-center h-screen\">\r\n      <h2 className=\"text-xl font-bold\">Meeting ID: {meetingId}</h2>\r\n\r\n      {meetingLink && (\r\n        <div className=\"flex flex-col items-center space-y-2 mt-4 bg-white p-4 rounded-lg shadow-lg\">\r\n          <p className=\"text-lg font-semibold\">Share this link:</p>\r\n          <div className=\"flex items-center space-x-2 border p-2 rounded-md w-full\">\r\n            <span className=\"truncate w-64\">{meetingLink}</span>\r\n            <button\r\n              className=\"bg-green-500 text-white px-3 py-1 rounded-md hover:bg-green-600\"\r\n              onClick={copyLink}\r\n            >\r\n              {copied ? \"Copied!\" : \"Copy\"}\r\n            </button>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"flex space-x-4 mt-4\">\r\n        <video ref={myVideoRef} autoPlay muted className=\"w-48 h-32 border rounded-lg\" />\r\n        <div id=\"remote-videos\" className=\"flex space-x-2\"></div>\r\n      </div>\r\n\r\n      {/* ✅ Mute, Video & Leave Buttons */}\r\n      <div className=\"flex space-x-4 mt-6\">\r\n        <button\r\n          onClick={toggleMute}\r\n          className=\"px-4 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600\"\r\n        >\r\n          {isMuted ? \"Unmute Mic\" : \"Mute Mic\"}\r\n        </button>\r\n\r\n        <button\r\n          onClick={toggleVideo}\r\n          className=\"px-4 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600\"\r\n        >\r\n          {isVideoOff ? \"Turn On Camera\" : \"Turn Off Camera\"}\r\n        </button>\r\n\r\n        <button\r\n          onClick={leaveMeeting}\r\n          className=\"px-4 py-2 bg-red-500 text-white rounded-md hover:bg-red-600\"\r\n        >\r\n          Leave Call\r\n        </button>\r\n      </div>\r\n      {isAdmin && pendingUsers.length > 0 && (\r\n        <div className=\"absolute top-10 right-10 bg-white p-4 rounded-lg shadow-lg\">\r\n          <h3 className=\"text-lg font-bold\">Approval Requests</h3>\r\n          {pendingUsers.map((peerId) => (\r\n            <div key={peerId} className=\"flex justify-between items-center\">\r\n              <span>{peerId}</span>\r\n              <button\r\n                onClick={() => approveUser(peerId)}\r\n                className=\"bg-green-500 text-white px-3 py-1 rounded-md hover:bg-green-600\"\r\n              >\r\n                Approve\r\n              </button>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MeetingPage;\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 510, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}